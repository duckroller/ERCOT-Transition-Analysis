---
title: "Data Dictionary"
output: html_notebook
---

This notebook is for making up a data dictionary.

```{r}
rm(list=ls())
```

```{r}
library(readr)
library(kableExtra)
library(zoo)
```

```{r}
annual_plant_level_data <- read_csv("data/Cleaned Data/eGRID_ercot.csv")
daily_fuel_mix_report <- read_csv("data/Cleaned Data/fuel_mix_report_clean_wide.csv")
daily_fuel_mix_report[is.na(daily_fuel_mix_report)] <- 0
hourly_spot_prices_DAM <- read_csv("data/Cleaned Data/spot_prices_DAM.csv")
annual_wind_turbine_data <- read_csv("data/Cleaned Data/txwtdb.csv")

```
```{r}
hourly_hubavg_spot_price_DAM <- hourly_spot_prices_DAM[hourly_spot_prices_DAM$`Settlement Point` == "HB_HUBAVG",]

hourly_hubavg_spot_price_DAM$date_time <- paste(hourly_hubavg_spot_price_DAM$`Delivery Date`, hourly_hubavg_spot_price_DAM$`Hour Ending`)
```

```{r}
#kable(head(annual_plant_level_data, 10), format = "html", caption = "Portion of dataset")
```

Going to use the zoo package to make these time series a little easier to work with...


```{r}

stat <- function(x) c(min_spot_price = min(x), max_spot_price = max(x), mean_spot_price = mean(x))

spot_price_zoo <- read.zoo(file = "data/Cleaned Data/hourly_hubavg_spot_price_DAM.csv", header = TRUE, sep = ",", format = "%Y-%m-%d", aggregate = stat)
```


```{r}

fuel_mix_zoo <- read.zoo(file="data/Cleaned Data/fuel_mix_report_clean_wide.csv", header = TRUE, sep=",", format = "%Y-%m-%d")

```


```{r}

plant_level_zoo <- read.zoo(file="data/Cleaned Data/eGRID_wide_aggregate.csv", header = TRUE, sep=",", format = "%Y")

```

```{r}
#turbine_zoo <- read.zoo(file="data/Cleaned Data/txwtdb.csv", header = TRUE, sep=",", format = "%Y")
```


```{r}
#annual_wind_turbine_data <-  annual_wind_turbine_data[!is.na(annual_wind_turbine_data$p_year),]

#turbine_zoo <- read.zoo(annual_wind_turbine_data, format="%Y")
```

```{r}
naive_merge <- merge(fuel_mix_zoo, plant_level_zoo, spot_price_zoo)
```

```{r}
write.zoo(naive_merge, file="data/Cleaned Data/cleaned_timeseries_data.csv", index.name = "Date")
```

